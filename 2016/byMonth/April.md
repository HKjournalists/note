## 4-26 ##

###1. LTV问题。
|游戏|date|ltv-1|ltv-2|ltv-5|ltv-7|ltv-15|ltv-30|ltv-60|ltv-90|
| :--: |:--:| :--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|
| 梦幻天堂| 4-25|  | |
| 梦幻天堂| 4-25--5-25|  | |
某一天或者某一时段注册的用户在未来N天内产生的价值。
> **百科：LTV是在一定时间内，某一客户可能为企业带来的利润额. 顾客终身价值是指企业在获得新顾客后的一段时间内，每一位顾客的平均利润净现值。**

那这个该怎么计算呢？  
目前公司老系统是直接查询原表，各种查询，每次需要做大量查询和计算：这一段时间内这个应用注册哪些用户，这些用户在他们注册时间起后1天 2天 1周直到N天的消费总额。后台查询一次耗时以分钟来记，而且占用大量CPU和数据库IO。。。肯定是不行的！！！  

> **难点：需要追踪一批用户未来比较长一段时间内的消费。**  
> **突破点：将某天某应用新注册或者说新增的用户划分为一个群体，**  
> 
>数据库设计
>
|游戏|date|当天的新增用户数|截止到当前这一天这批用户的消费总额amount|ltv-1|ltv-2|ltv-5|ltv-7|ltv-15|ltv-30|ltv-60|ltv-90|
| :--: |:--:|:--:| :--:|  :--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|
| 梦幻天堂| 4-24|  | |
| 梦幻天堂| 4-25|  | |
这样的话，每天结束，就能计算出当天新增用户数。  
**以后每增加一笔消费订单，将该订单的消费额归类到某天某游戏这批人的amount上，amount会一直增加.**  
每当时间间隔到了需要的天数，上面就是1，2，5，7，15，30，60，90.就自动计算对应的LTV值。

**perfect!**